<ui:composition template="/WEB-INF/templates/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:p="http://primefaces.org/ui">
    <!-- @author Amanda Pan <daikiraidemodaisuki@gmail.com> -->
    <ui:define name="title">Message</ui:define>
    <ui:define name="content">
        <h1>Message</h1>
        <b:form>
            <b:inputText id="message" value="#{mesageBean.message}"/>
            <b:button onclick="wsSendMessage();" value="Echo"/>
	</b:form>
        <br></br>
	<textarea id="echoText" rows="5" cols="30"></textarea>
        <!-- source: https://examples.javacodegeeks.com/enterprise-java/tomcat/apache-tomcat-websocket-tutorial/ -->
	<script type="text/javascript">
            var webSocket = new WebSocket("ws://localhost:8080/Tut4YouWebApp/chat");
            var echoText = document.getElementById("echoText");
            echoText.value = "";
            var message = document.getElementById("message");
            webSocket.onopen = function(message){ wsOpen(message);};
            webSocket.onmessage = function(message){ wsGetMessage(message);};
            webSocket.onclose = function(){ wsCloseConnection();};
            webSocket.onerror = function(message){ wsError(message);};
            function wsOpen(message){
                echoText.value += "You are now connected with" + "\n";
            }
            function wsSendMessage(){
                webSocket.send(message.value);
                //echoText.value += message.value + "\n"; --> this is for echoing
                message.value = "";
            }
            function wsCloseConnection(){
                webSocket.close();
            }
            function wsGetMessage(message){
                echoText.value += message.data + "\n";
            }
            function wserror(message){
                echoText.value += "Error... \n";
            }
	</script>
        <ui:debug hotkey='x' />
    </ui:define>
</ui:composition>